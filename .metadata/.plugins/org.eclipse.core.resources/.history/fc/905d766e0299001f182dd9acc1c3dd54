<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.suus.mapper.ChartMapper">

	<select id="findYearlyData" resultType="kr.suus.dto.ChartResDto">
	    SELECT YEAR as Year, SUM(USAGE_TIME) AS UsageTime
	    FROM Usage_data
	    WHERE COMPANY_ID = #{companyId}
	      AND Year >= YEAR(CURDATE()) - 5
	    GROUP BY Year, COMPANY_ID
	</select>

<select id="findMonthlyData" resultType="kr.suus.dto.ChartResDto">
    SELECT year, month, NULL AS day, SUM(usage_time) AS usageTime
    FROM usage_data
    WHERE company_id = #{companyId}
      AND CONCAT(year, '-', month) >= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 YEAR), '%Y-%m')
    GROUP BY year, month, company_id
</select>

<select id="findWeeklyData" resultType="kr.suus.dto.ChartResDto">
    SELECT year, month, day, SUM(usage_time) AS usageTime
    FROM usage_data
    WHERE company_id = #{companyId}
      AND CONCAT(year, '-', month, '-', day) >= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 7 DAY), '%Y-%m-%d')
    GROUP BY year, month, day, company_id
</select>
	
</mapper>